```mermaid
graph LR
    subgraph AWS Cloud
        direction TB
        EMR[<img src='[https://static-00.iconduck.com/assets.00/aws-emr-icon-512x512-vzvyx5kd.png](https://static-00.iconduck.com/assets.00/aws-emr-icon-512x512-vzvyx5kd.png)' width='50' /><br>EMR Serverless<br>(Spark + Sedona)]
        S3[<img src='[https://static-00.iconduck.com/assets.00/aws-s3-icon-512x485-6behde35.png](https://static-00.iconduck.com/assets.00/aws-s3-icon-512x485-6behde35.png)' width='50' /><br>Amazon S3<br>(Processed Data)]
        ECS[<img src='[https://static-00.iconduck.com/assets.00/aws-ecs-icon-512x492-bg8jo95r.png](https://static-00.iconduck.com/assets.00/aws-ecs-icon-512x492-bg8jo95r.png)' width='50' /><br>ECS Task<br>(Python Loader)]
    end

    subgraph On-Premise / VPC
        direction TB
        Postgres[<img src='[https://static-00.iconduck.com/assets.00/postgresql-icon-469x512-v2d0csm0.png](https://static-00.iconduck.com/assets.00/postgresql-icon-469x512-v2d0csm0.png)' width='45' /><br>PostgreSQL]
    end
    
    Airflow[<img src='[https://static-00.iconduck.com/assets.00/apache-airflow-icon-512x512-9a7z53j7.png](https://static-00.iconduck.com/assets.00/apache-airflow-icon-512x512-9a7z53j7.png)' width='50' /><br>Apache Airflow]

    Airflow -- "1. Aciona Job Spark" --> EMR
    EMR -- "4. Processa com Spark/Sedona" --> EMR
    Postgres -- "3. Lê dados brutos" --> EMR
    EMR -- "5. Salva dados processados" --> S3
    S3 -- "7. Lê dados processados" --> ECS
    Airflow -- "6. Aciona Task de Carga" --> ECS
    ECS -- "8. Carrega dados na tabela final" --> Postgres

    classDef aws fill:#232F3E,stroke:#fff,stroke-width:2px,color:#fff;
    class EMR,S3,ECS aws;
```
